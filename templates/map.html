<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ì„œìš¸ì‹œ ì˜ë¥˜ìˆ˜ê±°í•¨ ì§€ë„</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Maps API -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCHmMxsmDeGtL6VLI5a34USu1jDCLqPnbo"></script>

    <script>
      let map;
      const locations = {
        "ë™ì‘êµ¬": { lat: 37.5023, lng: 126.9486 },
        "ê°•ë‚¨êµ¬": { lat: 37.5172, lng: 127.0473 },
        "ì„œì´ˆêµ¬": { lat: 37.4836, lng: 127.0326 }
      };

      async function initMap() {
        const response = await fetch('/bins');
        const bins = await response.json();

        map = new google.maps.Map(document.getElementById("map"), {
          zoom: 13,
          center: locations["ë™ì‘êµ¬"],
        });

        bins.forEach(bin => {
          const marker = new google.maps.Marker({
            position: { lat: bin.lat, lng: bin.lng },
            map,
            title: bin.name,
          });

          const infoWindow = new google.maps.InfoWindow({
            content: `<b>${bin.name}</b><br>${bin.address}`,
          });

          marker.addListener('click', () => {
            infoWindow.open(map, marker);
            document.getElementById("info").innerHTML = `
              <div class="bg-white p-4 rounded-lg shadow-md border">
                <h2 class="text-xl font-semibold text-green-700">${bin.name}</h2>
                <p class="text-gray-700">${bin.address}</p>
              </div>
            `;
          });
        });
      }

      function moveToGu(guName) {
        const location = locations[guName];
        map.setCenter(location);
        map.setZoom(14);
      }
    </script>
  </head>

  <body class="bg-gray-50 text-gray-900 font-sans" onload="initMap()">
    <!-- í—¤ë” -->
    <header class="bg-gradient-to-r from-green-500 to-emerald-600 text-white py-6 shadow-md">
      <div class="text-center">
        <h1 class="text-4xl font-bold">ğŸ‘• ì„œìš¸ì‹œ ì˜ë¥˜ìˆ˜ê±°í•¨ ìœ„ì¹˜ ì•ˆë‚´</h1>
        <p class="text-sm mt-1">ë™ì‘êµ¬ / ê°•ë‚¨êµ¬ / ì„œì´ˆêµ¬ë³„ ìˆ˜ê±°í•¨ ìœ„ì¹˜ í™•ì¸</p>
      </div>
    </header>

    <!-- êµ¬ ì„ íƒ ë²„íŠ¼ -->
    <section class="flex justify-center gap-4 my-6">
      <button onclick="moveToGu('ë™ì‘êµ¬')" class="bg-white border px-4 py-2 rounded-lg shadow hover:bg-green-100 transition">ë™ì‘êµ¬</button>
      <button onclick="moveToGu('ê°•ë‚¨êµ¬')" class="bg-white border px-4 py-2 rounded-lg shadow hover:bg-green-100 transition">ê°•ë‚¨êµ¬</button>
      <button onclick="moveToGu('ì„œì´ˆêµ¬')" class="bg-white border px-4 py-2 rounded-lg shadow hover:bg-green-100 transition">ì„œì´ˆêµ¬</button>
    </section>

    <!-- ì§€ë„ -->
    <main class="flex flex-col items-center px-4">
      <div id="map" class="w-full max-w-5xl h-[600px] rounded-xl shadow-lg"></div>
      <div id="info" class="w-full max-w-5xl mt-6"></div>
    </main>
  </body>
</html>